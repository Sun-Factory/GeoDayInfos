<!DOCTYPE html>
<html>
<head>
<script src="./Suncalc/suncalc.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">



 <script>
    function getCoordinates() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showCoordinates);
      } else {
        document.getElementById("coordinates").innerHTML = "Geolocation is not supported by this browser.";
      }
    }

    function showCoordinates(position) {
     // Récupération des valeurs saisies par l'utilisateur
		var latitude = document.getElementById("latitude").value;
		var longitude = document.getElementById("longitude").value;
	    document.getElementById('latitude').value = position.coords.latitude;
        document.getElementById('longitude').value = position.coords.longitude;
	 // Récupération de la date saisie par l'utilisateur
		var date = new Date();
		calculateSunData();
	}
    getCoordinates();
	
  </script>
</head>


<body>
<div>
</div>	

      <img src="./pics/Earth.png" id="image_entete">

<div id="suncalc-results">

 <form>
      <label><input type="text" id="latitude" placeholder="Entrez la latitude"></label>
      <label><input type="text" id="longitude" placeholder="Entrez la longitude"></label>
</form>	
	
	<div 
	<button id="submit-button" onclick="calculateSunData(); event.preventDefault();"><img id="refreshed" src="./pics/refresh_gray.svg"</button>
	</div>	
	
	
<table>
  <tr>
    <td rowspan="5" id="col_image"><img src="./pics/sun.png" id="Image_sun"></td>
  </tr>
  <tr>
	<td>Sunrise</td>
	<td id="col_right" colspan="2">
    <span id="dawn-time"></span> - <span id="sunrise-time"></span>
	</td>

  </tr>
  	  <tr>
		<td>Zenith</td>
		<td id="col_right" colspan="2">
		<span id="solar-noon-time"></span>
		</td>
	  </tr>
  
	  <tr>
	  <td>Sunset</td>
	  
		<td id="col_right" colspan="2">
		<span id="sunset-time"></span> - <span id="dusk-time"></span> 
		</td>
	  </tr>
</table>
	
<table>
  <tr>
    <td rowspan="5" id="col_image"><img src="./pics/ocean.png" id="Image_ocean"></td>
  </tr>

    <tr>
      <td>Wind Speed</td>
      <td id="wind-speed"></td>
    </tr>
    <tr>
      <td>Wind Direction</td>
      <td id="wind-direction"></td>
    </tr>
</table>
	
	
<table>
  <tr>
    <td rowspan="5" id="col_image"><img src="./pics/Full_moon.png" id="Image_moon"></td>
  </tr>
  <tr>
	<td>Moonrise</td>
		<td id="col_right" colspan="2">
		<span id="moonrise-time"></span>
		</td>
  </tr> 
	  <tr>
		<td>Moonset</td>
				<td id="col_right" colspan="2">
		<span id="moonset-time"></span>
		</td>
	  </tr>
</table>

   <script>
   // Calculs solaires
    // Afficher la date du jour par défaut
    var today = new Date();


    function calculateSunData() {
      // Récupération des valeurs saisies par l'utilisateur
      var latitude = document.getElementById("latitude").value;
      var longitude = document.getElementById("longitude").value;
      var date = new Date();
	  

      // Récupération de toutes les données de SunCalc pour cette date et ces coordonnées
      var sunData = SunCalc.getTimes(date, latitude, longitude);
  
	  // Afficher les données dans la table
	  document.getElementById("sunrise-time").innerHTML = sunData.sunrise.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
	  document.getElementById("solar-noon-time").innerHTML = sunData.solarNoon.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
	  document.getElementById("sunset-time").innerHTML = sunData.sunset.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
  
	  var dawn = SunCalc.getTimes(date, latitude, longitude).dawn;
	  var dusk = SunCalc.getTimes(date, latitude, longitude).dusk;
	  document.getElementById("dawn-time").innerHTML = dawn.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
	  document.getElementById("dusk-time").innerHTML = dusk.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});  

	// Obtenha as informações da lua para a data atual e as coordenadas geográficas atuais
	var lunarTimes = SunCalc.getMoonTimes(date, latitude, longitude);

	// Extraia os valores
	var moonriseTime = lunarTimes.rise;
	var moonsetTime = lunarTimes.set;


	// Defina os elementos HTML que exibirão as informações
	var moonriseTimeElement = document.getElementById("moonrise-time");
	var moonsetTimeElement = document.getElementById("moonset-time");

	// Atribua os tempos extraídos aos elementos HTML
	moonriseTimeElement.innerHTML = moonriseTime.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
	moonsetTimeElement.innerHTML = moonsetTime.toLocaleTimeString('fr-FR', {hour: '2-digit', minute:'2-digit'});
	
	const API_KEY = "75f4694d5be7367d385d68f2bb50aca4";

fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${API_KEY}`)
  .then(response => response.json())
  .then(data => {
    const weatherData = data;
    const windSpeed = document.getElementById("wind-speed");
    const windDirection = document.getElementById("wind-direction");
    windSpeed.innerHTML = `${weatherData.wind.speed} m/s`;
    windDirection.innerHTML = `${weatherData.wind.deg} &#176;`;
  })
  .catch(error => {
    console.log(error);
  });
}

calculateSunData();

  </script>
  
</html>
